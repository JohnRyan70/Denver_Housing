
library(maptools)
library(rgdal)
library(sp)
library(ggplot2)
library(ggmap)
library(digest)
library(Hmisc)
gpclibPermit()
library(psych)
library(ggthemes)
library(RColorBrewer)
library(colorspace)


###########################
#
#
# Exploration of data
#
# Try correlations of interesting variables

cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_Yrs_Perc_18Plus, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_Yrs_Perc_65Plus, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_MedianAge, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_OldAgeDependencyRatio, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_ChildDependencyRatio, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_Perc_Under18, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_Perc_20to29, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_Perc_30to39, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_Perc_40to49, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_Perc_50to59, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Tot_Pop_Perc_60to69, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_35to50K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_35to50K_Owner, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_50to75K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_50to75K_Owner, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_75to100K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_75to100K_Owner, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_Perc_25KandBelow, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_Owner_Perc_25KandBelow, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_Perc_25Kto75K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_Owner_Perc_25Kto75K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_Perc_75KandAbove, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Occ_HousingUnits_HHInc12Mos_Owner_Perc_75KandAbove, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$HHs_AvgFamilySize, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$HHs_AvgFamilySize_MarriedCoupleFamily, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$HHs_Households_Total_UnitsinStructure_OneUnitStructure, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$HHs_Households_Total_UnitsinStructure_TwoPlusUnitStructure, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$HHs_Perc_MarriedCoupleFamilyOnly, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_MedianAge, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_NotHSGrad, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_HSGrad, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_SomeCollegetoAADegree, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_BADegree, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_GradorProfessionalDegree, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_25to35K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_35to50K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_50to65K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_65to75K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_75KPlus, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_PovertyStatusDetermined_Below100PercentPovertyLevel, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_AtLeast_HSDegree, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_AtLeastBADegree, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_Upto25K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_25Kto75K, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_75KPlus, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$SCs_TotalPop_Perc_Upto150PercentPovertyLevel, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$House_MedianYearBuilt, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$HousingUnits_Perc_Vacant, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$TvRO_Perc_Owner, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$TvRO_Perc_Renter, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$WS_Past12Mos_16to64_MeanUsualHrsWorked, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Same_School_Year_Ranking, use = "pairwise.complete.obs", method = c("pearson"))
cor(ACSData9$HouseValue_Median, ACSData9$Last_School_Year_Ranking, use = "pairwise.complete.obs", method = c("pearson"))


# A few graphs for visual relationships



library(plotly)
library(ggplot2)

qplot(x = HouseValue_Median, data = ACSData9, binwidth = 5000,
      xlab = 'Number of neighborhoods',
      ylab = 'Median housing value')


p1 <- ggplot(aes(x = Occ_HousingUnits_HHInc12Mos_Owner_Perc_25KandBelow, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
           labs(x="Percent of Owners with Income below $25K", y="Median House Value")
p1 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p2 <-ggplot(aes(x = Occ_HousingUnits_HHInc12Mos_Owner_Perc_25Kto75K, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Percent of Owners with Income from $25K to $75K", y="Median House Value")
p2 + stat_smooth(method = "lm", alpha = .2, size = 0.5)


p3 <-ggplot(aes(x = Occ_HousingUnits_HHInc12Mos_Owner_Perc_75KandAbove, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Percent of Owners with Income at Least $75K", y="Median House Value")
p3 + stat_smooth(method = "lm", alpha = .2, size = 0.5)


p4 <-ggplot(aes(x = HHs_Perc_MarriedCoupleFamilyOnly, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Percent of Households as Married-Couple Families", y="Median House Value")
p4 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p5 <-ggplot(aes(x = SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Median Individual Income", y="Median House Value")
p5 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p6 <-ggplot(aes(x = SCs_TotalPop_25YrsPlus_EducationLevel_Perc_AtLeastBADegree, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Percent of People with at Least Bachelor's Degree", y="Median House Value")
p6 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p7 <-ggplot(aes(x = SCs_TotalPop_Perc_Upto150PercentPovertyLevel, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Percent of People Living Below 150 Percent of Poverty Level", y="Median House Value")
p7 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p8 <-ggplot(aes(x = House_MedianYearBuilt, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Median Year House Built", y="Median House Value")
p8 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p9 <-ggplot(aes(x = HousingUnits_Perc_Vacant, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Percent of Housing Units as Vacant", y="Median House Value")
p9 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p10 <-ggplot(aes(x = TvRO_Perc_Renter, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Percent of Units Rented [vs. Owned]", y="Median House Value")
p10 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p11 <-ggplot(aes(x = WS_Past12Mos_16to64_MeanUsualHrsWorked, 
           y = HouseValue_Median), data = ACSData9) +
           geom_point(alpha = .4) +
          labs(x="Person's Average Usual Hours Worked", y="Median House Value")
p11 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p12 <-ggplot(aes(x = Same_School_Year_Ranking, y = HouseValue_Median), data = ACSData9) +
            geom_point(alpha = .4) + 
            labs(x="School District Ranking, Same Year", y="Median House Value")
p12 + stat_smooth(method = "lm", alpha = .2, size = 0.5)

p13 <-ggplot(aes(x = Last_School_Year_Ranking, y = HouseValue_Median), data = ACSData9) +
            geom_point(alpha = .4) + 
            labs(x="School District Ranking, Previous Year", y="Median House Value")
p13 + stat_smooth(method = "lm", alpha = .2, size = 0.5)


#
#
#################################################################
#
#  Start mapping
#  Define map source type and color
#

DenverMetro <- c(-106, 40.3, -104, 39.1)
DenverMetroMap <- get_map(location=DenverMetro, source = "google", 
                          maptype = "roadmap", zoom = 11, crop=FALSE)
ggmap(DenverMetroMap)



###########################
# 
# Plot median housing value
# 

describe(ACSData10$HouseValue_Median, na.rm = TRUE)
quantile(ACSData10$HouseValue_Median, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

# Plot median housing values
ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = HouseValue_Median),
             data = ACSData10, color="black", alpha = .4, size = .2)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = HouseValue_Median),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .449900, .383700, .331300, .273400, .241200, .209000, .159800, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Median House Value by Census Tract, 2013')

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = HouseValue_Median),
             data = ACSData10, alpha = .4, size = .2) +
            scale_colour_brewer(palette = "Purples") +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Median House Value by Census Tract, 2013')

#########################
#
# Plot Low-income households
#

describe(ACSData10$Occ_HousingUnits_HHInc12Mos_Owner_Perc_25KandBelow, na.rm = TRUE)
quantile(ACSData10$Occ_HousingUnits_HHInc12Mos_Owner_Perc_25KandBelow, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Occ_HousingUnits_HHInc12Mos_Owner_Perc_25KandBelow),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Occ_HousingUnits_HHInc12Mos_Owner_Perc_25KandBelow),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .182625, .137, .105, .089, .07, .04975, .031, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Percent Owners with Household Income Below $25K')

##########################################
# 
# Plot middle-income values
#

describe(ACSData10$Occ_HousingUnits_HHInc12Mos_Owner_Perc_25Kto75K, na.rm = TRUE)
quantile(ACSData10$Occ_HousingUnits_HHInc12Mos_Owner_Perc_25Kto75K, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Occ_HousingUnits_HHInc12Mos_Owner_Perc_25Kto75K),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Occ_HousingUnits_HHInc12Mos_Owner_Perc_25Kto75K),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .559, .482, .425875, .367, .319125, .264, .200375, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Percent Owners with Household Income from $25K to $75K')



##########################################
# 
# Plot upper-income values
#

describe(ACSData10$Occ_HousingUnits_HHInc12Mos_Owner_Perc_75KandAbove, na.rm = TRUE)
quantile(ACSData10$Occ_HousingUnits_HHInc12Mos_Owner_Perc_75KandAbove, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Occ_HousingUnits_HHInc12Mos_Owner_Perc_75KandAbove),
             data = ACSData10, color="black", alpha = .4, size = .2)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Occ_HousingUnits_HHInc12Mos_Owner_Perc_75KandAbove),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .735625, .673250, .600875, .541, .45325, .38175, .266, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Percent Owners with Household Income Above $75K')



##########################################
# 
# Plot married-couple values
#

describe(ACSData10$HHs_Perc_MarriedCoupleFamilyOnly, na.rm = TRUE)
quantile(ACSData10$HHs_Perc_MarriedCoupleFamilyOnly, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = HHs_Perc_MarriedCoupleFamilyOnly),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = HHs_Perc_MarriedCoupleFamilyOnly),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(100, .7139986, .6287926, .5412984, .4774722, .4193193, .3575155, .2693803, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Percent Married Couple Families by Census Tract, 2013')

##########################################
# 
# Plot median individual income values
#

describe(ACSData10$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome, na.rm = TRUE)
describe(ACSData9$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome, na.rm = TRUE)
describe(Selected_Chars_ACS_13_DHP$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome, na.rm = TRUE)

quantile(ACSData10$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)
quantile(Selected_Chars_ACS_13_DHP$SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome),
             data = ACSData10, color="black", alpha = .4, size = .2)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = SCs_TotalPop_15YrsPlus_IndividualIncomePast12MosInflAdj_MedianIncome),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1080000, 50190.5, 43077.5, 38849.5, 34052, 30669, 26064, 21449.5)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Median Individual Income')

##########################################
# 
# Plot percent with college degree values
#

describe(ACSData10$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_AtLeastBADegree, na.rm = TRUE)
quantile(ACSData10$SCs_TotalPop_25YrsPlus_EducationLevel_Perc_AtLeastBADegree, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = SCs_TotalPop_25YrsPlus_EducationLevel_Perc_AtLeastBADegree),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = SCs_TotalPop_25YrsPlus_EducationLevel_Perc_AtLeastBADegree),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .626, .55, .469, .386, .301, .2305, .137, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Percent of People with A College Degree or More')


##########################################
# 
# Plot percent of people below 150 percent poverty level values
#

describe(ACSData10$SCs_TotalPop_Perc_Upto150PercentPovertyLevel, na.rm = TRUE)
quantile(ACSData10$SCs_TotalPop_Perc_Upto150PercentPovertyLevel, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)
ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = SCs_TotalPop_Perc_Upto150PercentPovertyLevel),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = SCs_TotalPop_Perc_Upto150PercentPovertyLevel),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .39925, .3045, .21975, .159, .118, .0785, .05075, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Percent Living Below 150 Perent Poverty Level')


##################################
#
# Plot median year built values
#

describe(ACSData10$House_MedianYearBuilt, na.rm = TRUE)
quantile(ACSData10$House_MedianYearBuilt, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = House_MedianYearBuilt),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = House_MedianYearBuilt),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(2016, 2002, 1996, 1989, 1984, 1978, 1972, 1962, 1900)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Median Year House Built by Census Tract, 2013')

####################################
# 
# Plot percent vacant data
#

describe(ACSData10$HousingUnits_Perc_Vacant, na.rm = TRUE)
quantile(ACSData10$HousingUnits_Perc_Vacant, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

# Plot percent vacant values
ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = HousingUnits_Perc_Vacant),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = HousingUnits_Perc_Vacant),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .112186, .0865384, .070072, .05555555, .0427586, .0305454, .0157255, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Percent Housing Units Vacant by Census Tract, 2013')

####################################
# 
# Plot renter data

describe(ACSData10$TvRO_Perc_Renter, na.rm = TRUE)
quantile(ACSData10$TvRO_Perc_Renter, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

# Plot percent renter built values
ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = TvRO_Perc_Renter),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = TvRO_Perc_Renter),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .55385, .412833, .29147, .207485, .1540913, .097891, .057106, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Percent Housing Units Rented by Census Tract, 2013')

####################################
#
# Plot mean hours worked past 12 months data
#

describe(ACSData10$WS_Past12Mos_16to64_MeanUsualHrsWorked, na.rm = TRUE)
quantile(ACSData10$WS_Past12Mos_16to64_MeanUsualHrsWorked, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

# Plot mean hours worked values

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = WS_Past12Mos_16to64_MeanUsualHrsWorked),
             data = ACSData10, color="black", alpha = .4, size = .2)


ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = WS_Past12Mos_16to64_MeanUsualHrsWorked),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .412, .4022, .399, .394, .388, .382, .374, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('Avg Number of Weekly Hours Worked by Census Tract, 2013')

####################################
#
# Plot school district rank data

describe(ACSData10$Same_School_Year_Ranking, na.rm = TRUE)
quantile(ACSData10$Same_School_Year_Ranking, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Same_School_Year_Ranking),
             data = ACSData10, color="black", alpha = .4, size = .2)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Same_School_Year_Ranking),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .763, .682, .59, .59, .558, .316, .294, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('School District State Rank, Same Year, by Census Tract, 2013')

describe(ACSData10$Last_School_Year_Ranking, na.rm = TRUE)
quantile(ACSData10$Last_School_Year_Ranking, c(.875, .75, .625, .5, .375, .25, .125), na.rm = TRUE)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Last_School_Year_Ranking),
             data = ACSData10, color="black", alpha = .4, size = .2)

ggmap(DenverMetroMap) + 
  geom_polygon(aes(x = long, y = lat, group=id, fill = Last_School_Year_Ranking),
             data = ACSData10, color="black", alpha = .4, size = .2) +
            scale_fill_gradientn(colours = c("red4", "red2", "red", "lightcoral", "lightblue3", "cyan4", "blue", "midnightblue"),
                       values = c(1, .768, .659, .601, .557, .263, .263, .220, 0)) +
  labs(x = 'Longitude', y = 'Latitude') + ggtitle('School District State Rank, Previous Year, by Census Tract, 2013')

#
#
###########################################################################
#

